---
name: generate-plan
description: Generate a plan.md document for a medium-complexity GitHub issue. Use this skill when an issue has the label 'plan: medium' and needs planning documentation before implementation. For complex issues (plan: complex), use the plan-check orchestrator instead which handles staged approval.
allowed-tools:
  - Bash(gh:*)
  - Bash(mkdir:*)
  - Read
  - Glob
  - Grep
  - Write
  - Edit
---

# Generate Plan (Medium Tier)

Create a single `plan.md` document for medium-complexity issues.

## Prerequisites

- Issue must have `plan: medium` label
- If issue has `plan: simple`: No plan needed, already has `plan ready`
- If issue has `plan: complex`: Use `/plan-check` orchestrator for staged approval workflow

## Process

1. **Fetch issue**: `gh issue view [NUMBER] --json number,title,body,labels`
2. **Verify tier**: Confirm `plan: medium` label exists
3. **Create directory**: `mkdir -p .claude/plans/issue-[N]-[slug]`
4. **Analyze codebase**: Review affected areas thoroughly
5. **Generate plan.md**: Using template below
6. **Add label**: `gh issue edit [N] --add-label "plan ready"`
7. **Post summary**: Comment on issue

---

## Plan Template

Create `.claude/plans/issue-[N]-[slug]/plan.md`:

```markdown
# Plan: Issue #[N] - [Title]

## Summary
[2-3 sentences describing the change]

## Requirements
- [Requirement 1]
- [Requirement 2]

## Approach
[Technical approach - 2-3 paragraphs]

### Key Decisions
1. **[Decision]**: [Rationale]

## Implementation

### Files to Modify
| File | Changes |
|------|---------|
| `path/file.ts` | [What changes] |

### Files to Create
| File | Purpose |
|------|---------|
| `path/new.ts` | [Purpose] |

### Database Changes
[SQL or "None required"]

## Tasks
- [ ] [Task 1]
- [ ] [Task 2]
- [ ] Write tests

## Testing Strategy
[How to verify]

## Risks
- [Risk and mitigation]
```

---

## Label Update

```bash
gh issue edit [N] --add-label "plan ready"
```

## Post Summary Comment

```bash
gh issue comment [N] --body "## Planning Complete

**Tier:** Medium
**Plan location:** \`.claude/plans/issue-[N]-[slug]/plan.md\`

### Summary
[Brief summary of planned approach]

---
*Plan generated by Claude*"
```

## Output Format

```json
{
  "issue": 5,
  "tier": "medium",
  "plan_directory": ".claude/plans/issue-5-slug/",
  "documents_created": ["plan.md"],
  "status": "success"
}
```
