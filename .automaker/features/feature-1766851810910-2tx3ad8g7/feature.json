{
  "category": "Uncategorized",
  "description": "## Parent Task Context (Already Completed)\n\n> **Note:** The following parent task has already been completed. This context is provided to help you understand the background and requirements for this sub-task. Do not re-implement the parent task - focus only on the new sub-task described below.\n\n### Migrate database schema from public to routeiq\n\n**Description:** Migrate Database Schema from Public to RouteIQ\n\nUpdate the application's database references to use the `routeiq` schema instead of the default `public` schema for all database operations.\n\nRequirements:\n- Update all database queries, models, and ORM configurations to reference `routeiq` schema\n- Ensure proper schema qualification for the following tables:\n  - clients\n  - services\n  - vehicles\n- Update any database connection configurations or initialization scripts to set default schema\n- Verify all CRUD operations work correctly against the new schema\n- Update any raw SQL queries to include schema prefix (e.g., `routeiq.clients` instead of `clients`)\n- Check for and update any migration files or seeding scripts\n- Ensure foreign key relationships work across the schema\n- Test all database-dependent features to confirm successful migration\n- Update any database utility functions or helpers that assume `public` schema\n\nEdge Cases to Consider:\n- Existing data in `public` schema (if migration of data is needed, clarify with stakeholder)\n- Mixed references where some tables might still need to reference `public` schema\n- Database views or stored procedures that may reference the old schema\n- Any third-party integrations or tools that expect `public` schema\n\n---\n\n## Task Description\n\nI need you to confirm that all dependencies have been updated as it relates to the schema changing from public to routeiq.\n\nAcceptance Criteria:\n\n1. Given the schema has been renamed from \"public\" to \"routeiq\", when searching the codebase for database references, then no hardcoded \"public\" schema references should remain in SQL queries, migrations, or ORM configurations.\n\n2. Given database connection configurations exist, when reviewing connection strings and database configuration files, then all schema references should point to \"routeiq\" instead of \"public\".\n\n3. Given ORM models or entity definitions exist, when inspecting model decorators and annotations, then all schema declarations should specify \"routeiq\" as the target schema.\n\n4. Given database migration files exist, when reviewing all migration scripts, then all CREATE, ALTER, DROP, and other DDL statements should target the \"routeiq\" schema.\n\n5. Given raw SQL queries exist in the application code, when searching for SQL strings and query builders, then all table references should use \"routeiq\" schema prefix (e.g., \"routeiq.table_name\").\n\n6. Given there are database stored procedures or functions, when reviewing their definitions, then they should be created in and reference the \"routeiq\" schema.\n\n7. Given database seeds or fixtures exist, when checking data initialization scripts, then all INSERT statements should target tables in the \"routeiq\" schema.\n\n8. Given the application has integration tests, when running the full test suite against a test database, then all tests should pass without schema-related errors.\n\n9. Given environment-specific configurations exist (dev, staging, prod), when reviewing each environment's database settings, then all environments should consistently reference the \"routeiq\" schema.\n\n10. Given database backup and restore procedures exist, when reviewing operational documentation and scripts, then all procedures should account for the \"routeiq\" schema name.",
  "title": "Verify all database schema references updated to routeiq",
  "images": [],
  "imagePaths": [],
  "textFilePaths": [],
  "skipTests": false,
  "model": "sonnet",
  "thinkingLevel": "medium",
  "branchName": "main",
  "priority": 2,
  "planningMode": "spec",
  "requirePlanApproval": true,
  "dependencies": [
    "feature-1766849589622-lrxo5khqn"
  ],
  "titleGenerating": false,
  "status": "completed",
  "id": "feature-1766851810910-2tx3ad8g7",
  "startedAt": "2025-12-27T16:11:04.578Z",
  "updatedAt": "2025-12-27T16:18:39.279Z",
  "planSpec": {
    "status": "approved",
    "version": 1,
    "reviewedByUser": true,
    "generatedAt": "2025-12-27T16:11:56.240Z",
    "tasks": [
      {
        "id": "T001",
        "description": "Update default schema from 'public' to 'routeiq' in config",
        "filePath": "src/config/index.ts",
        "status": "pending"
      },
      {
        "id": "T002",
        "description": "Update vehicles table schema from public to routeiq",
        "filePath": "supabase/migrations/20251227072000_create_vehicles_table.sql",
        "status": "pending"
      },
      {
        "id": "T003",
        "description": "Update SUPABASE_SCHEMA default value to routeiq",
        "filePath": ".env.example",
        "status": "pending"
      },
      {
        "id": "T004",
        "description": "Fix schema reference in service.service.ts comment",
        "filePath": "src/services/service.service.ts",
        "status": "pending"
      }
    ],
    "tasksTotal": 4,
    "tasksCompleted": 4,
    "approvedAt": "2025-12-27T16:17:26.536Z",
    "currentTaskId": "T004"
  }
}