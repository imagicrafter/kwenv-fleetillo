# ============================================================================
# Dispatch Service Environment Configuration
# ============================================================================
# Copy this file to .env and fill in your values
# NEVER commit .env files with real credentials to version control
#
# The dispatch service can run in two modes:
#   - Embedded: Runs within web-launcher (uses root .env)
#   - Standalone: Runs as separate service (uses this .env)
#
# For standalone mode, this file is required.
# For embedded mode, configure these values in the root .env file.
# ============================================================================

# ============================================================================
# Server Configuration
# ============================================================================

# Server port (default: 3001)
PORT=3001

# Environment: development | production | test
NODE_ENV=development

# Logging level: debug | info | warn | error
LOG_LEVEL=info

# ============================================================================
# REQUIRED: Supabase Configuration
# ============================================================================
# Shared with main Fleetillo application
# Find these values in: Supabase Dashboard > Project Settings > API

# Your Supabase project URL
SUPABASE_URL=https://your-project.supabase.co

# Supabase anonymous key (optional, for read operations)
SUPABASE_KEY=your-supabase-anon-key

# Supabase service role key - REQUIRED for dispatch operations
# This key bypasses Row Level Security to update driver/route records
SUPABASE_SERVICE_ROLE_KEY=your-supabase-service-role-key

# Database schema (must match main app)
SUPABASE_SCHEMA=fleetillo

# ============================================================================
# REQUIRED: API Authentication
# ============================================================================

# Comma-separated list of valid API keys for client authentication
# IMPORTANT: Each API key must be at least 32 characters long
# Generate with: openssl rand -base64 32
DISPATCH_API_KEYS=your-dispatch-api-key-minimum-32-characters

# ============================================================================
# REQUIRED: Application URLs
# ============================================================================

# Base URL for generating links in dispatch messages
# This URL appears in driver notifications for route access
APP_BASE_URL=https://your-app-domain.com

# Webhook URL for Telegram updates (production only)
# Set this after deployment, then register with Telegram API
# WEBHOOK_URL=https://your-domain.com/dispatch/api/v1/telegram/webhook

# ============================================================================
# Telegram Bot Configuration
# ============================================================================
# Create a bot via @BotFather on Telegram

# Bot token from @BotFather (required for Telegram notifications)
TELEGRAM_BOT_TOKEN=your-telegram-bot-token

# Secret token for webhook validation (production only)
# Generate with: openssl rand -hex 32
# Register this with Telegram when setting up webhook
TELEGRAM_WEBHOOK_SECRET=your-webhook-secret-64-hex-characters

# ============================================================================
# Email Provider Configuration
# ============================================================================
# Choose one provider for email notifications

# Supported providers: resend | sendgrid
EMAIL_PROVIDER=resend

# Resend API key (recommended)
# Get from: https://resend.com/api-keys
RESEND_API_KEY=your-resend-api-key

# SendGrid API key (alternative)
# Get from: https://app.sendgrid.com/settings/api_keys
# SENDGRID_API_KEY=your-sendgrid-api-key

# Sender email configuration
# Note: Domain must be verified with your email provider
EMAIL_FROM_ADDRESS=dispatch@yourdomain.com
EMAIL_FROM_NAME=Fleetillo Dispatch

# ============================================================================
# Channel Configuration
# ============================================================================

# Default notification channel when driver has no preference
# Options: telegram | email
DEFAULT_CHANNEL=telegram

# ============================================================================
# CORS Configuration
# ============================================================================
# Required for production when UI is on different domain

# Comma-separated list of allowed origins
# Leave empty for development (allows all origins)
# Production example: https://fleetillo.com,https://app.fleetillo.com
CORS_ORIGIN=

# ============================================================================
# Rate Limiting Configuration
# ============================================================================
# Protects against API abuse

# Rate limit window in milliseconds (default: 60000 = 1 minute)
RATE_LIMIT_WINDOW_MS=60000

# Maximum requests per window per IP (default: 100)
RATE_LIMIT_MAX_REQUESTS=100
